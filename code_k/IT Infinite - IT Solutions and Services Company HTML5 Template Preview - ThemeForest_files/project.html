<!DOCTYPE html>
<html lang="zxx" class="lenis" style="--scrollbar-width: 4px">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="keywords" content="HTML5 Template, Project Details" />
        <meta
            name="description"
            content="Hexa Tech - Detailed view of our innovative projects"
        />
        <meta name="author" content="kayancode.com" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />
        <title>Hexa Tech - Project Details</title>

        <!-- Favicon -->
        <link rel="shortcut icon" href="assets/images/favicon.ico" />

        <!-- CSS Files -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
            rel="stylesheet"
        />
        <link href="assets/style/css2.css" rel="stylesheet" />
        <link href="assets/style/bootstrap.min.css" rel="stylesheet" />
        <link href="assets/style/magnific-popup.css" rel="stylesheet" />
        <link href="assets/style/owl.carousel.min.css" rel="stylesheet" />
        <link href="assets/style/swiper.min.css" rel="stylesheet" />
        <link href="assets/style/style.css" rel="stylesheet" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;500;600;700;800;900&family=Jost:ital,wght@0,100..900;1,100..900&family=Russo+One&display=swap"
            rel="stylesheet"
        />

        <style>
            body {
                font-family: "Cairo", sans-serif;
                background-color: #121212;
                color: #ffffff;
                line-height: 1.6;
            }
            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                font-family: "Russo One", "Cairo", sans-serif;
                color: #ffffff;
            }
            .english-lang {
                font-family: "Jost", sans-serif;
                direction: ltr;
            }
            .arabic-lang {
                font-family: "Cairo", sans-serif;
                direction: rtl;
            }
            .project-hero {
                padding: 80px 0;
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                text-align: center;
                position: relative;
                overflow: hidden;
            }
            .project-hero::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: url("assets/images/subtitle-icon.png") no-repeat
                    center;
                background-size: 50%;
                opacity: 0.05;
                z-index: 0;
            }
            .project-hero .sub-title {
                font-size: 1.2rem;
                color: #00c4b4;
                margin-bottom: 10px;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
            }
            .project-hero .title {
                font-size: 2.5rem;
                font-weight: 700;
                margin-bottom: 20px;
                animation: fadeInUp 0.8s ease-out;
            }
            .project-section {
                padding: 60px 0;
                background-color: #1a1a1a;
            }
            .carousel-item img {
                max-height: 600px;
                object-fit: cover;
                border-radius: 10px;
                transition: transform 0.5s ease;
                loading: lazy;
            }
            .carousel-item img:hover {
                transform: scale(1.05);
            }
            .carousel-caption {
                background: rgba(0, 0, 0, 0.7);
                border-radius: 5px;
                padding: 10px;
            }
            .list-group-item1 {
                background-color: #2a2a2a;
                color: #fff;
                border: none;
                border-radius: 8px;
                margin-bottom: 10px;
                padding: 15px;
                transition: background-color 0.3s ease;
            }
            .list-group-item {
                background-color: #1a1a1a;
                color: #fff;
                border: none;
                border-radius: 8px;
                margin-bottom: 10px;
                padding: 15px;
                transition: background-color 0.3s ease;
            }
            .list-group-item1:hover,
            .list-group-item:hover {
                background-color: #3a3a3a;
            }
            .list-group-item1,
            .list-group-item strong {
                color: #00c4b4;
            }
            .video-container {
                position: relative;
                padding-bottom: 56.25%; /* 16:9 aspect ratio */
                height: 0;
                overflow: hidden;
                border-radius: 10px;
                margin-bottom: 30px;
            }
            .video-container iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }
            .error-container {
                text-align: center;
                padding: 40px;
                background: #2a2a2a;
                border-radius: 10px;
                margin: 20px 0;
            }
            .error-container .btn-retry {
                background-color: #ff4d4f;
                border: none;
                padding: 10px 20px;
                border-radius: 50px;
                color: #fff;
            }
            .error-container .btn-retry:hover {
                background-color: #e6393b;
            }
            .image-error {
                background-color: #2a2a2a;
                color: #ff4d4f;
                text-align: center;
                padding: 10px;
                border-radius: 5px;
                margin-bottom: 10px;
            }
            .service-image {
                max-width: 100%;
                max-height: 200px;
                object-fit: cover;
                border-radius: 8px;
                margin-top: 10px;
                loading: lazy;
            }
            .icon-link {
                color: #00c4b4;
                font-size: 1.5rem;
                margin-left: 10px;
                transition: color 0.3s ease;
            }
            .icon-link:hover {
                color: #00a69a;
            }
            .btn-back {
                background: linear-gradient(135deg, #00c4b4 0%, #00968a 100%);
                border: none;
                padding: 14px 28px;
                border-radius: 50px;
                font-weight: 600;
                font-size: 1rem;
                color: #ffffff;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(0, 196, 180, 0.3);
                position: relative;
                overflow: hidden;
            }
            .btn-back::before {
                content: "";
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.2),
                    transparent
                );
                transition: left 0.5s ease;
            }
            .btn-back:hover {
                background: linear-gradient(135deg, #00a69a 0%, #008a7a 100%);
                transform: translateY(-3px);
                box-shadow: 0 6px 20px rgba(0, 196, 180, 0.4);
            }
            .btn-back:hover::before {
                left: 100%;
            }
            .btn-back:active {
                transform: translateY(-1px);
            }
            .btn-back i {
                font-size: 1.1rem;
                transition: transform 0.3s ease;
            }
            .btn-back:hover i {
                transform: translateX(-3px);
            }
            @media (max-width: 768px) {
                .project-hero .title {
                    font-size: 1.8rem;
                }
                .carousel-item img {
                    max-height: 400px;
                }
                .service-image {
                    max-height: 150px;
                }
                .btn-back {
                    padding: 12px 24px;
                    font-size: 0.95rem;
                }
            }
        </style>
    </head>
    <body>
        <div id="page" class="main">
            <!-- Include Header -->
            <div id="header-container"></div>

            <div class="site-content" x-data="projectDetail">
                <!-- Hero Section -->
                <section class="project-hero">
                    <div class="container">
                        <span class="sub-title fade-in">
                            <img
                                class="img-fluid"
                                src="assets/images/subtitle-icon.png"
                                alt="Project Subtitle Icon"
                                width="24"
                            />
                            <span
                                x-text="projectData.service?.title || 'Project'"
                            ></span>
                        </span>
                        <h1
                            class="title fade-in"
                            x-text="projectData.title || 'Project Details'"
                        ></h1>
                    </div>
                </section>

                <!-- Main Project Section -->
                <section class="project-section">
                    <div class="container">
                        <!-- Loading State -->
                        <div
                            id="projectLoading"
                            class="text-white text-center py-4 fade-in"
                            x-show="isLoading"
                        >
                            <i class="fas fa-spinner fa-spin me-2"></i>Loading
                            project details...
                        </div>

                        <!-- Error State -->
                        <div
                            id="projectError"
                            class="error-container"
                            x-show="errorMessage"
                        >
                            <p
                                class="text-white mb-4"
                                x-text="errorMessage"
                            ></p>
                            <button
                                class="btn btn-retry"
                                @click="fetchProjectData()"
                            >
                                Retry
                            </button>
                        </div>

                        <!-- Project Content -->
                        <div
                            id="projectContent"
                            x-show="!isLoading && !errorMessage"
                        >
                            <div class="row g-4">
                                <!-- Project Images Carousel -->
                                <div class="col-lg-6">
                                    <div
                                        x-show="!projectData.images || projectData.images.length === 0"
                                        class="image-error"
                                    >
                                        No images available for this project.
                                    </div>
                                    <div
                                        id="projectImagesCarousel"
                                        class="carousel slide mb-4"
                                        data-bs-ride="carousel"
                                        x-show="projectData.images && projectData.images.length > 0"
                                    >
                                        <div class="carousel-inner">
                                            <template
                                                x-for="image in projectData.images"
                                                :key="image.image_path"
                                            >
                                                <div
                                                    :class="['carousel-item', { active: $index === 0 }]"
                                                >
                                                    <img
                                                        :src="image.image_path || 'assets/images/placeholder.jpg'"
                                                        class="d-block w-100 img-fluid"
                                                        :alt="projectData.title || 'Project Image'"
                                                        loading="lazy"
                                                        @error="handleImageError($event)"
                                                    />
                                                    <div
                                                        class="carousel-caption d-none d-md-block"
                                                    >
                                                        <h5
                                                            x-text="projectData.title || 'Project Image'"
                                                        ></h5>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                        <button
                                            class="carousel-control-prev"
                                            type="button"
                                            data-bs-target="#projectImagesCarousel"
                                            data-bs-slide="prev"
                                            aria-label="Previous"
                                        >
                                            <span
                                                class="carousel-control-prev-icon"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                        <button
                                            class="carousel-control-next"
                                            type="button"
                                            data-bs-target="#projectImagesCarousel"
                                            data-bs-slide="next"
                                            aria-label="Next"
                                        >
                                            <span
                                                class="carousel-control-next-icon"
                                                aria-hidden="true"
                                            ></span>
                                        </button>
                                    </div>

                                    <!-- Video Player (if video_url is valid) -->
                                    <div
                                        class="video-container"
                                        x-show="isValidVideoUrl(projectData.video_url)"
                                    >
                                        <iframe
                                            :src="getVideoEmbedUrl(projectData.video_url)"
                                            frameborder="0"
                                            allow="autoplay; encrypted-media"
                                            allowfullscreen
                                            title="Project Video"
                                        ></iframe>
                                    </div>
                                </div>

                                <!-- Project Details -->
                                <div class="col-lg-6">
                                    <h4 class="mb-3 fade-in">
                                        Project Information
                                    </h4>
                                    <ul class="list-group mb-4">
                                        <li class="list-group-item fade-in">
                                            <strong>Title:</strong>
                                            <span
                                                x-text="projectData.title || 'N/A'"
                                            ></span>
                                        </li>
                                        <li class="list-group-item fade-in">
                                            <strong>Description:</strong>
                                            <span
                                                x-text="projectData.description || 'No description available'"
                                            ></span>
                                        </li>
                                        <li
                                            class="list-group-item1 fade-in"
                                            x-show="projectData.project_url"
                                        >
                                            <strong>Project URL:</strong>
                                            <a
                                                :href="projectData.project_url"
                                                target="_blank"
                                                rel="noopener noreferrer"
                                                class="icon-link"
                                                :title="projectData.project_url || 'Visit Project'"
                                            >
                                                <i class="fas fa-link"></i>
                                            </a>
                                        </li>
                                        <li
                                            class="list-group-item1 fade-in"
                                            x-show="projectData.video_url"
                                        >
                                            <strong>Video:</strong>
                                            <a
                                                :href="projectData.video_url"
                                                target="_blank"
                                                rel="noopener noreferrer"
                                                class="icon-link"
                                                :title="projectData.video_url || 'Watch Video'"
                                            >
                                                <i class="fas fa-video"></i>
                                            </a>
                                        </li>
                                    </ul>

                                    <h4 class="mb-3 fade-in">
                                        Service Details
                                    </h4>
                                    <ul class="list-group mb-4">
                                        <li class="list-group-item fade-in">
                                            <strong>Service Title:</strong>
                                            <span
                                                x-text="projectData.service?.title || 'N/A'"
                                            ></span>
                                        </li>
                                        <li class="list-group-item fade-in">
                                            <strong
                                                >Service Description:</strong
                                            >
                                            <span
                                                x-text="projectData.service?.description || 'No description available'"
                                            ></span>
                                        </li>
                                        <li class="list-group-item fade-in">
                                            <strong>Service Image:</strong>
                                            <div
                                                x-show="projectData.service?.image_path"
                                            >
                                                <img
                                                    :src="projectData.service?.image_path || 'assets/images/placeholder.jpg'"
                                                    class="service-image"
                                                    :alt="projectData.service?.title || 'Service Image'"
                                                    loading="lazy"
                                                    @error="handleImageError($event)"
                                                />
                                            </div>
                                            <span
                                                x-show="!projectData.service?.image_path"
                                                >No image available</span
                                            >
                                        </li>
                                    </ul>

                                    <h4 class="mb-3 fade-in">Features</h4>
                                    <ul class="list-group mb-4">
                                        <template
                                            x-for="feature in projectData.features"
                                            :key="feature.feature_text"
                                        >
                                            <li
                                                class="list-group-item fade-in"
                                                x-text="feature.feature_text || 'N/A'"
                                            ></li>
                                        </template>
                                        <li
                                            class="list-group-item fade-in"
                                            x-show="!projectData.features || projectData.features.length === 0"
                                        >
                                            No features available
                                        </li>
                                    </ul>

                                    <a
                                        href="page2.html"
                                        class="btn btn-back fade-in"
                                        role="button"
                                        aria-label="Back to Projects"
                                    >
                                        <i class="fas fa-arrow-left me-2"></i
                                        >Back to Projects
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Include Footer -->
            <div id="footer-container"></div>
        </div>

        <!-- JavaScript Libraries -->
        <script src="https://unpkg.com/i18next/dist/umd/i18next.min.js"></script>
        <script src="https://unpkg.com/i18next-browser-languagedetector/i18nextBrowserLanguageDetector.js"></script>
        <script src="https://unpkg.com/i18next-http-backend/i18nextHttpBackend.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        <!-- JavaScript Files -->
        <script src="assets/js/bootstrap.min.js"></script>
        <script src="assets/js/jquery.appear.js"></script>
        <script src="assets/js/jquery.countTo.js"></script>
        <script src="assets/js/jquery.magnific-popup.js"></script>
        <script src="assets/js/owl.carousel.min.js"></script>
        <script src="assets/js/popper.min.js"></script>
        <script src="assets/js/shuffle.min.js"></script>
        <script src="assets/js/swiper.min.js"></script>
        <script src="assets/js/SwiperAnimation.min.js"></script>
        <script src="assets/js/translations.js"></script>
        <script src="assets/js/config.js"></script>

        <!-- Project Detail Script -->
        <script>
            document.addEventListener("alpine:init", () => {
                Alpine.data("projectDetail", () => ({
                    projectData: {},
                    isLoading: true,
                    errorMessage: "",
                    apiBaseUrl:
                        typeof API_CONFIG !== "undefined" &&
                        API_CONFIG.BASE_URL_Renter
                            ? API_CONFIG.BASE_URL_Renter
                            : "http://127.0.0.1:8000",

                    async init() {
                        await this.$nextTick();
                        this.fetchProjectData();
                    },

                    async fetchProjectData() {
                        try {
                            this.isLoading = true;
                            this.errorMessage = "";
                            const urlParams = new URLSearchParams(
                                window.location.search
                            );
                            const projectId = urlParams.get("id");
                            if (!projectId) {
                                this.errorMessage = "Project ID is missing";
                                this.isLoading = false;
                                this.showToast(
                                    "danger",
                                    "Project ID is missing"
                                );
                                return;
                            }

                            const token =
                                localStorage.getItem("authToken") ||
                                "your-test-token";
                            if (!token) {
                                this.errorMessage =
                                    "Authentication token missing";
                                this.isLoading = false;
                                this.showToast(
                                    "danger",
                                    "Authentication token missing"
                                );
                                return;
                            }

                            const response = await fetch(
                                `${this.apiBaseUrl}/api/projects/show/${projectId}`,
                                {
                                    method: "GET",
                                    headers: {
                                        Accept: "application/json",
                                        Authorization: `Bearer ${token}`,
                                    },
                                }
                            );

                            if (!response.ok) {
                                throw new Error(
                                    `HTTP error! status: ${response.status}`
                                );
                            }

                            const data = await response.json();
                            if (data.status === "success" && data.data) {
                                this.projectData = data.data;
                                console.log("Project Data:", this.projectData);
                                this.isLoading = false;
                            } else {
                                throw new Error(
                                    data.message || "Invalid response format"
                                );
                            }
                        } catch (error) {
                            this.errorMessage =
                                error.message ||
                                "Failed to fetch project details";
                            this.isLoading = false;
                            this.showToast("danger", this.errorMessage);
                        }
                    },

                    isValidVideoUrl(url) {
                        if (!url) return false;
                        const youtubeRegex =
                            /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
                        const vimeoRegex =
                            /(?:vimeo\.com\/|player\.vimeo\.com\/video\/)(\d+)/;
                        return youtubeRegex.test(url) || vimeoRegex.test(url);
                    },

                    getVideoEmbedUrl(url) {
                        if (!url) return "";
                        const youtubeRegex =
                            /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
                        const vimeoRegex =
                            /(?:vimeo\.com\/|player\.vimeo\.com\/video\/)(\d+)/;
                        if (youtubeRegex.test(url)) {
                            const match = url.match(youtubeRegex);
                            return `https://www.youtube.com/embed/${match[1]}`;
                        } else if (vimeoRegex.test(url)) {
                            const match = url.match(vimeoRegex);
                            return `https://player.vimeo.com/video/${match[1]}`;
                        }
                        return "";
                    },

                    handleImageError(event) {
                        console.error(
                            "Image failed to load:",
                            event.target.src
                        );
                        event.target.src = "assets/images/placeholder.jpg";
                    },

                    showToast(color, message) {
                        if (typeof Swal !== "undefined") {
                            const toast = Swal.mixin({
                                toast: true,
                                position: "bottom-start",
                                icon: color === "success" ? "success" : "error",
                                title: message,
                                showConfirmButton: false,
                                timer: 3000,
                                showCloseButton: true,
                                customClass: { popup: `color-${color}` },
                            });
                            toast.fire();
                        }
                    },
                }));
            });
        </script>

        <!-- Component Loader -->
        <script>
            $(document).ready(function () {
                let loadedComponents = 0;
                const totalComponents = 2;

                function checkAllLoaded(componentName) {
                    loadedComponents++;
                    console.log(
                        `${componentName} loaded, ${loadedComponents}/${totalComponents}`
                    );
                }

                function handleLoadError(componentName, xhr, status, error) {
                    console.error(
                        `Error loading ${componentName}.html: ${status} (${xhr.status}) - ${error}`
                    );
                    console.log(
                        `Response text: ${xhr.responseText.substring(
                            0,
                            200
                        )}...`
                    );
                    checkAllLoaded(componentName);
                }

                $("#header-container").load(
                    "assets/components/Header.html",
                    function (response, status, xhr) {
                        if (status === "error")
                            handleLoadError(
                                "Header",
                                xhr,
                                status,
                                xhr.statusText
                            );
                        else checkAllLoaded("Header");
                    }
                );

                $("#footer-container").load(
                    "assets/components/Footer.html",
                    function (response, status, xhr) {
                        if (status === "error")
                            handleLoadError(
                                "Footer",
                                xhr,
                                status,
                                xhr.statusText
                            );
                        else checkAllLoaded("Footer");
                    }
                );
            });
        </script>
    </body>
</html>
