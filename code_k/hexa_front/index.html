<!DOCTYPE html>
<html lang="ar" dir="rtl" class="no-js">
    <head>
        <!-- ============================================
             Document Metadata & SEO
             ============================================ -->
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
        />
        <meta name="format-detection" content="telephone=no" />

        <!-- Primary Meta Tags -->
        <title>HexaTerminal | Software & Web Development Company</title>
        <meta
            name="title"
            content="HexaTerminal | Software & Web Development Company"
        />
        <meta
            name="description"
            content="HexaTerminal is a professional software development company specializing in innovative digital solutions, web development, and cutting-edge technology services."
        />
        <meta
            name="description:ar"
            content="هيكسا تيرمينال هي شركة برمجيات احترافية متخصصة في الحلول الرقمية المبتكرة وتطوير الويب وخدمات التكنولوجيا المتطورة."
        />
        <meta
            name="keywords"
            content="HexaTerminal, Software Development, Web Development, IT Solutions, Digital Transformation, Technology Services, Software Company"
        />
        <meta name="author" content="HexaTerminal Team" />
        <meta name="robots" content="index, follow" />
        <meta name="language" content="Arabic, English" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://hexa-terminal.com" />
        <meta
            property="og:title"
            content="HexaTerminal | Software Development Company"
        />
        <meta
            property="og:description"
            content="Innovative software development and digital solutions for your business growth."
        />
        <meta
            property="og:image"
            content="https://hexa-terminal.com/assets/images/og-image.jpg"
        />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />
        <meta property="og:locale" content="ar_AR" />
        <meta property="og:locale:alternate" content="en_US" />

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:url" content="https://hexa-terminal.com" />
        <meta
            name="twitter:title"
            content="HexaTerminal | Software Development Company"
        />
        <meta
            name="twitter:description"
            content="Innovative software development and digital solutions."
        />
        <meta
            name="twitter:image"
            content="https://hexa-terminal.com/assets/images/og-image.jpg"
        />

        <!-- Favicon -->
        <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico" />
        <link rel="apple-touch-icon" href="assets/images/apple-touch-icon.png" />

        <!-- ============================================
             Critical Resource Preloading
             ============================================ -->
        <link
            rel="preload"
            href="assets/libs/css/font-awesome.min.css"
            as="style"
        />
        <link
            rel="preload"
            href="assets/libs/css/cairo-font.css"
            as="style"
        />
        <link
            rel="preload"
            href="assets/style/bootstrap.min.css"
            as="style"
        />
        <link
            rel="preload"
            href="assets/style/style.css"
            as="style"
        />
        <link
            rel="preload"
            href="assets/style/header.css"
            as="style"
        />
        <link
            rel="preconnect"
            href="https://fonts.googleapis.com"
            crossorigin="anonymous"
        />
        <link
            rel="dns-prefetch"
            href="https://fonts.googleapis.com"
        />

        <!-- ============================================
             Stylesheets (Ordered by Priority)
             ============================================ -->
        <!-- Core Styles -->
        <link
            href="assets/libs/css/font-awesome.min.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
            <link
                href="assets/libs/css/font-awesome.min.css"
                rel="stylesheet"
            />
        </noscript>
        <link
            href="assets/libs/css/cairo-font.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
        <link href="assets/libs/css/cairo-font.css" rel="stylesheet" />
        </noscript>
        <link href="assets/style/bootstrap.min.css" rel="stylesheet" />
        <link href="assets/style/css2.css" rel="stylesheet" />
        <link href="assets/style/style.css" rel="stylesheet" type="text/css" />
        <link href="assets/style/header.css" rel="stylesheet" type="text/css" />

        <!-- Component Styles -->
        <link
            href="assets/style/magnific-popup.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
        <link href="assets/style/magnific-popup.css" rel="stylesheet" />
        </noscript>
        <link
            href="assets/style/owl.carousel.min.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
        <link href="assets/style/owl.carousel.min.css" rel="stylesheet" />
        </noscript>
        <link
            href="assets/style/swiper.min.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
        <link href="assets/style/swiper.min.css" rel="stylesheet" />
        </noscript>
        <link
            href="assets/style/all.min.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
            <link href="assets/style/all.min.css" rel="stylesheet" />
        </noscript>
        <link
            href="assets/libs/css/sweetalert2.min.css"
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
            <link
                href="assets/libs/css/sweetalert2.min.css"
                rel="stylesheet"
            />
        </noscript>

        <style>
            /* شاشة التحميل */
            #loading-screen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: #fff;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                transition: opacity 0.5s ease;
                overflow: hidden; /* Only loading screen should not scroll */
                pointer-events: none; /* Allow clicks to pass through when hidden */
            }
            
            #loading-screen[aria-hidden="true"] {
                display: none !important; /* Completely remove when hidden */
            }

            .loading-logo {
                font-size: 2.5rem;
                font-weight: bold;
                margin-bottom: 20px;
                color: #333;
            }

            .loading-spinner {
                width: 50px;
                height: 50px;
                border: 5px solid #f3f3f3;
                border-top: 5px solid #3498db;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }

            .loading-text {
                font-size: 1rem;
                color: #666;
                text-align: center;
            }

            .loading-progress {
                width: 200px;
                height: 4px;
                background-color: #f0f0f0;
                border-radius: 2px;
                margin-top: 10px;
                overflow: hidden;
            }

            .loading-progress-bar {
                height: 100%;
                background-color: #3498db;
                width: 0%;
                transition: width 0.3s ease;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            #page {
                opacity: 0;
                transition: opacity 0.5s ease;
                visibility: hidden;
                overflow-y: auto;
                overflow-x: hidden;
                height: auto;
                min-height: 100vh;
            }
            #page.loaded {
                opacity: 1;
                visibility: visible;
                overflow-y: auto !important;
                overflow-x: hidden !important;
                height: auto !important;
                min-height: 100vh !important;
            }
            
            /* Ensure text is visible even if fonts fail to load */
            body {
                font-family: 'Cairo', 'Segoe UI', Tahoma, Arial, sans-serif !important;
            }
            
            /* Prevent FOUT (Flash of Unstyled Text) */
            .font-loading {
                visibility: hidden;
            }
            
            .font-loaded {
                visibility: visible;
            }

            .error-message {
                background-color: #f8d7da;
                color: #721c24;
                padding: 15px;
                border-radius: 5px;
                margin: 10px 0;
                text-align: center;
                border: 1px solid #f5c6cb;
            }

            .retry-button {
                background-color: #007bff;
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 4px;
                cursor: pointer;
                margin-top: 10px;
                transition: background-color 0.3s ease;
            }

            .retry-button:hover,
            .retry-button:focus {
                background-color: #0056b3;
                outline: 2px solid #0056b3;
                outline-offset: 2px;
            }

            /* Skip to main content link (Accessibility) */
            .skip-to-main-content {
                position: absolute;
                top: -100px;
                left: 0;
                background: #000;
                color: #fff;
                padding: 1rem;
                text-decoration: none;
                z-index: 10000;
                border: 2px solid #fff;
            }

            .skip-to-main-content:focus {
                top: 0;
            }

            /* Loading state */
            body.loading {
                overflow: hidden;
            }
            
            body.loaded {
                overflow: auto !important;
                overflow-y: auto !important;
            }
            
            body.loaded #page {
                overflow: visible;
                overflow-y: auto !important;
            }
            
            /* Force enable scrolling when page is loaded */
            html.scroll-enabled,
            body.scroll-enabled {
                overflow: auto !important;
                overflow-y: auto !important;
                height: auto !important;
            }


            /* Reduced motion preference */
            @media (prefers-reduced-motion: reduce) {
                *,
                *::before,
                *::after {
                    animation-duration: 0.01ms !important;
                    animation-iteration-count: 1 !important;
                    transition-duration: 0.01ms !important;
                }
            }
        </style>
    </head>

    <body class="loading" data-theme="dark">
        <!-- ============================================
             Loading Screen (Accessibility Enhanced)
             ============================================ -->
        <div
            id="loading-screen"
            role="status"
            aria-live="polite"
            aria-label="جاري تحميل الصفحة"
        >
            <div class="loading-logo" aria-hidden="true">HexaTerminal</div>
            <div class="loading-spinner" aria-hidden="true"></div>
            <div class="loading-text" id="loading-status" aria-live="polite">
                جاري تحميل المحتوى...
            </div>
            <div class="loading-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="مستوى التحميل">
                <div
                    class="loading-progress-bar"
                    id="loading-progress-bar"
                    aria-hidden="true"
                ></div>
            </div>
        </div>

        <!-- ============================================
             Main Content (Semantic HTML5 Structure)
             ============================================ -->
        <div id="page" class="main" aria-hidden="true">
            <!-- Skip to main content link for accessibility -->
            <a href="#main-content" class="skip-to-main-content">
                التخطي إلى المحتوى الرئيسي
            </a>

            <!-- Header Section -->
            <header id="header-container" role="banner"></header>

            <!-- Main Content Area -->
            <main id="main-content" class="site-content" role="main">
                <!-- Hero/Banner Section -->
                <section id="banner-container" aria-label="القسم الرئيسي"></section>

                <!-- Services Hero Section -->
                <section
                    id="services-hero-container"
                    aria-labelledby="services-hero-title"
                ></section>

                <!-- Services List Section -->
                <section
                    id="services-list-container"
                    aria-labelledby="services-list-title"
                ></section>

                <!-- Projects Showcase Section -->
                <section
                    id="projects-showcase-container"
                    aria-labelledby="projects-showcase-title"
                ></section>

                <!-- Team Section -->
                <section
                    id="team-section-container"
                    aria-labelledby="team-section-title"
                ></section>

                <!-- Reviews Section -->
                <section
                    id="reviews-section-container"
                    aria-labelledby="reviews-section-title"
                ></section>

                <!-- FAQ Section -->
                <section
                    id="faq-container"
                    aria-labelledby="faq-section-title"
                ></section>

                <!-- Vision Section -->
                <section
                    id="vision-container"
                    aria-labelledby="vision-section-title"
                ></section>
            </main>

            <!-- Footer Section -->
            <footer id="footer-container" role="contentinfo"></footer>
        </div>

        <!-- JavaScript Libraries (محلي) -->
        <script src="assets/js/jquery-3.7.1.min.js"></script>
        <script src="assets/js/font-loader.js"></script>
        <script src="assets/libs/js/i18next.min.js"></script>
        <script src="assets/libs/js/i18next-browser-languagedetector.min.js"></script>
        <script src="assets/libs/js/i18next-http-backend.min.js"></script>
        <!-- Ensure CSS files are loaded on server -->
        <script>
            // Force load CSS files if they fail to load
            (function() {
                'use strict';
                
                function ensureCSSLoaded() {
                    const cssFiles = [
                        'assets/style/style.css',
                        'assets/style/header.css'
                    ];
                    
                    cssFiles.forEach(function(cssFile) {
                        const link = document.querySelector('link[href="' + cssFile + '"]');
                        if (link) {
                            // Check if CSS is loaded
                            const testLink = document.createElement('link');
                            testLink.rel = 'stylesheet';
                            testLink.href = cssFile;
                            testLink.onerror = function() {
                                console.warn('CSS file failed to load:', cssFile);
                                // Try to reload with absolute path
                                const absolutePath = window.location.origin + '/' + cssFile;
                                const newLink = document.createElement('link');
                                newLink.rel = 'stylesheet';
                                newLink.href = absolutePath;
                                newLink.type = 'text/css';
                                document.head.appendChild(newLink);
                            };
                            // If link doesn't have type, add it
                            if (!link.getAttribute('type')) {
                                link.setAttribute('type', 'text/css');
                            }
                        } else {
                            // CSS link not found, create it
                            const newLink = document.createElement('link');
                            newLink.rel = 'stylesheet';
                            newLink.href = cssFile;
                            newLink.type = 'text/css';
                            document.head.appendChild(newLink);
                        }
                    });
                }
                
                // Run on DOM ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', ensureCSSLoaded);
                } else {
                    ensureCSSLoaded();
                }
                
                // Also run after a short delay to catch late-loading issues
                setTimeout(ensureCSSLoaded, 100);
            })();
        </script>

        <script src="assets/libs/js/alpinejs.min.js" defer></script>
        <script src="assets/libs/js/sweetalert2.min.js"></script>
        <script src="assets/libs/js/lenis.min.js"></script>

        <!-- JavaScript Files -->
        <!-- Popper.js must be loaded before Bootstrap -->
        <script src="assets/js/popper.min.js"></script>
        <script src="assets/js/bootstrap.min.js"></script>
        <script src="assets/js/jquery.appear.js"></script>
        <script src="assets/js/jquery.countTo.js"></script>
        <script src="assets/js/jquery.magnific-popup.js"></script>
        <script src="assets/js/owl.carousel.min.js"></script>
        <script src="assets/js/shuffle.min.js"></script>
        <script src="assets/js/swiper.min.js"></script>
        <script src="assets/js/SwiperAnimation.min.js"></script>
        <script src="assets/js/translations.js"></script>

        <!-- Initialize Bootstrap Offcanvas after DOM is ready -->
        <script>
            // Fix Bootstrap backdrop issue by ensuring Popper is loaded
            // Note: We don't initialize offcanvas here to prevent auto-opening
            // Offcanvas will be initialized when user clicks the hamburger button
            let offcanvasInitialized = false;
            
            function initializeOffcanvasOnLoad() {
                // Only run once on initial page load, not after components are loaded
                if (offcanvasInitialized) return;
                offcanvasInitialized = true;
                
                // Ensure all offcanvas elements are hidden by default (only on initial load)
                const offcanvasElements = document.querySelectorAll('.offcanvas');
                offcanvasElements.forEach(function(element) {
                    // Only hide if not already showing and not currently being opened
                    if (!element.classList.contains('show') && 
                        !element.classList.contains('showing') &&
                        !element.hasAttribute('data-offcanvas-opening')) {
                        // Remove 'show' class if present (Bootstrap uses this to show offcanvas)
                        element.classList.remove('show');
                        // Ensure offcanvas is hidden
                        element.setAttribute('aria-hidden', 'true');
                        // Remove any inline styles that might show it
                        if (element.style.display === 'block') {
                            element.style.display = '';
                        }
                    }
                });
            }
            
            document.addEventListener('DOMContentLoaded', initializeOffcanvasOnLoad);
            
            // Prevent hiding offcanvas when it's being shown
            document.addEventListener('show.bs.offcanvas', function(event) {
                // Offcanvas is about to show, don't interfere
                console.log('Offcanvas is showing:', event.target.id);
                const element = event.target;
                // Mark that this offcanvas is opening
                element.setAttribute('data-offcanvas-opening', 'true');
                element.setAttribute('aria-hidden', 'false');
                // Ensure body has offcanvas-open class for Bootstrap
                document.body.classList.add('offcanvas-open');
            });
            
            document.addEventListener('shown.bs.offcanvas', function(event) {
                // Offcanvas is now shown, ensure it stays visible
                console.log('Offcanvas is shown:', event.target.id);
                const element = event.target;
                // Ensure it stays visible
                element.setAttribute('aria-hidden', 'false');
                element.classList.add('show');
                // Force visibility with inline styles as backup
                element.style.visibility = 'visible';
                element.style.display = 'flex';
                element.style.opacity = '1';
                // Ensure body has offcanvas-open class
                document.body.classList.add('offcanvas-open');
                // Remove the opening flag after a delay
                setTimeout(function() {
                    if (element.classList.contains('show')) {
                        element.removeAttribute('data-offcanvas-opening');
                    }
                }, 1000);
            });
            
            // When offcanvas is hidden, remove body class
            document.addEventListener('hidden.bs.offcanvas', function(event) {
                console.log('Offcanvas is hidden:', event.target.id);
                document.body.classList.remove('offcanvas-open', 'modal-open');
            });
            
            // Prevent hiding offcanvas when it's being hidden
            document.addEventListener('hide.bs.offcanvas', function(event) {
                // Only allow hiding if user explicitly closes it
                console.log('Offcanvas is hiding:', event.target.id);
            });
        </script>

        <!-- Component Scripts -->
        <script src="assets/components/Services/ServicesList.js"></script>
        <script src="assets/components/Services/ProjectsShowcase.js"></script>
        <script src="assets/components/Services/TeamSection.js"></script>
        <script src="assets/components/Services/FAQSection.js"></script>
        <script src="assets/components/Services/ReviewsSection.js"></script>
        <script src="assets/components/VideoSection.js"></script>
        <script src="assets/components/header.js"></script>

        <!-- Offcanvas Functions - Must be global for onclick handlers -->
        <script>
            /**
             * Safely open Bootstrap Offcanvas
             * @param {string} offcanvasId - The ID of the offcanvas element
             */
            function openOffcanvas(offcanvasId) {
                try {
                    if (typeof bootstrap === 'undefined') {
                        console.warn('Bootstrap is not loaded yet');
                        // Fallback: use data-bs-toggle attribute
                        const element = document.getElementById(offcanvasId);
                        if (element) {
                            const toggleBtn = document.querySelector(`[data-bs-target="#${offcanvasId}"]`);
                            if (toggleBtn) {
                                toggleBtn.setAttribute('data-bs-toggle', 'offcanvas');
                                toggleBtn.click();
                            }
                        }
                        return;
                    }

                    const element = document.getElementById(offcanvasId);
                    if (!element) {
                        console.error('Offcanvas element not found:', offcanvasId);
                        return;
                    }

                    // Check if Popper is available (required for backdrop)
                    if (typeof bootstrap.Offcanvas === 'undefined') {
                        console.warn('Bootstrap Offcanvas is not available');
                        return;
                    }

                    // Get or create instance with safe options
                    let offcanvas;
                    try {
                        offcanvas = bootstrap.Offcanvas.getOrCreateInstance(element, {
                            backdrop: true,
                            keyboard: true,
                            scroll: false
                        });
                    } catch (error) {
                        // If getOrCreateInstance fails, try without options
                        console.warn('Failed to create instance with options, trying without:', error);
                        try {
                            offcanvas = bootstrap.Offcanvas.getOrCreateInstance(element);
                        } catch (e) {
                            console.error('Failed to create offcanvas instance:', e);
                            return;
                        }
                    }

                    // Show the offcanvas
                    if (offcanvas && typeof offcanvas.show === 'function') {
                        // Ensure body has offcanvas-open class before showing
                        document.body.classList.add('offcanvas-open');
                        
                        // Force visibility before showing
                        element.style.visibility = 'visible';
                        element.style.display = 'flex';
                        element.style.opacity = '1';
                        element.style.zIndex = '1045';
                        
                        // Show the offcanvas
                        offcanvas.show();
                        
                        // Force visibility after a short delay to ensure it appears
                        setTimeout(function() {
                            if (element) {
                                element.style.visibility = 'visible';
                                element.style.display = 'flex';
                                element.style.opacity = '1';
                                element.style.zIndex = '1045';
                            }
                        }, 100);
                    }
                } catch (error) {
                    console.error('Error opening offcanvas:', error);
                }
            }

            /**
             * Close mobile menu offcanvas
             */
            function closeMobileMenu() {
                try {
                    const menuOffcanvas = document.getElementById('menuOffcanvas');
                    if (menuOffcanvas && typeof bootstrap !== 'undefined' && bootstrap.Offcanvas) {
                        const offcanvas = bootstrap.Offcanvas.getInstance(menuOffcanvas);
                        if (offcanvas) {
                            offcanvas.hide();
                        }
                    }
                } catch (error) {
                    console.error('Error closing mobile menu:', error);
                }
            }

            // Make functions globally available
            window.openOffcanvas = openOffcanvas;
            window.closeMobileMenu = closeMobileMenu;
        </script>

        <script>
            /**
             * ============================================
             * Component Loader System
             * ============================================
             * Manages dynamic loading of HTML components with:
             * - Error handling and retry logic
             * - Progress tracking
             * - Accessibility support
             * - Performance optimization
             * ============================================
             */
            
            'use strict';

            /**
             * Component loading state management
             * @type {Object}
             */
            const componentState = {
                loaded: 0,
                total: 0,
                errors: 0,
                maxRetries: 2,
                retryDelays: [1000, 3000],
                startTime: null,
            };

            /**
             * Update loading progress bar and status text
             * @param {number} progress - Progress percentage (0-100)
             */
            function updateProgress(progress = null) {
                const progressBar = document.getElementById("loading-progress-bar");
                const progressContainer = progressBar?.parentElement;
                const statusEl = document.getElementById("loading-status");
                
                // Calculate progress if not provided
                if (progress === null && componentState.total > 0) {
                    progress = Math.round((componentState.loaded / componentState.total) * 100);
                }
                
                // Update progress bar
                if (progressBar && progress !== null) {
                    progressBar.style.width = `${progress}%`;
                    if (progressContainer) {
                        progressContainer.setAttribute('aria-valuenow', progress);
                    }
                }
                
                // Update status text
                if (statusEl) {
                    let statusText = `جاري تحميل المحتوى... (${progress || 0}%)`;
                    if (componentState.errors > 0) {
                        statusText += ` - ${componentState.errors} أخطاء`;
                    }
                    statusEl.textContent = statusText;
                }
            }

            /**
             * Show page content after all components are loaded
             * Handles accessibility and performance optimizations
             */
            function showPage() {
                if (componentState.loaded + componentState.errors >= componentState.total) {
                    const loadingScreen = document.getElementById("loading-screen");
                    const page = document.getElementById("page");
                    const body = document.body;
                    
                    // Calculate load time
                    if (componentState.startTime) {
                        const loadTime = Date.now() - componentState.startTime;
                        console.log(`Page loaded in ${loadTime}ms`);
                    }
                    
                    // Fade out loading screen and enable scrolling immediately
                    setTimeout(() => {
                        // Enable scrolling FIRST before hiding loading screen
                        const html = document.documentElement;
                        html.classList.add("scroll-enabled");
                        html.style.overflow = '';
                        html.style.overflowY = '';
                        html.style.height = '';
                        
                        if (body) {
                            body.classList.remove("loading");
                            body.classList.add("loaded", "scroll-enabled");
                            body.style.overflow = '';
                            body.style.overflowY = '';
                            body.style.height = '';
                        }
                        
                        if (page) {
                            page.classList.add("loaded");
                            page.setAttribute('aria-hidden', 'false');
                            page.style.overflow = '';
                            page.style.overflowY = '';
                            page.style.height = '';
                        }
                        
                        if (loadingScreen) {
                            loadingScreen.style.opacity = "0";
                            loadingScreen.setAttribute('aria-hidden', 'true');
                        }

                        // Hide loading screen completely and ensure it doesn't block
                        setTimeout(() => {
                            if (loadingScreen) {
                                loadingScreen.style.display = "none";
                                loadingScreen.style.position = 'absolute';
                                loadingScreen.style.pointerEvents = 'none';
                            }
                            
                            // Final scroll enable check
                            html.style.overflow = '';
                            html.style.overflowY = '';
                            if (body) {
                                body.style.overflow = '';
                                body.style.overflowY = '';
                            }
                            if (page) {
                                page.style.overflow = '';
                                page.style.overflowY = '';
                            }

                            // Force enable scrolling - إصلاح نهائي للسكرول على السيرفر
                            function forceEnableScrolling() {
                                // Remove Lenis classes that might block scrolling
                                document.documentElement.classList.remove('lenis', 'lenis-smooth', 'lenis-stopped', 'lenis-locked');
                                
                                // Force enable scrolling on body and html
                                const html = document.documentElement;
                                const body = document.body;
                                
                                // Remove any inline styles that might block scrolling
                                html.style.overflow = '';
                                html.style.overflowY = '';
                                html.style.overflowX = '';
                                html.style.height = '';
                                html.style.maxHeight = '';
                                
                                body.style.overflow = '';
                                body.style.overflowY = '';
                                body.style.overflowX = '';
                                body.style.height = '';
                                body.style.maxHeight = '';
                                
                                // Force enable scrolling with CSS classes
                                html.classList.add('scroll-enabled');
                                body.classList.add('scroll-enabled', 'loaded');
                                
                                // Ensure page element allows scrolling
                                const page = document.getElementById('page');
                                if (page) {
                                    page.style.overflow = '';
                                    page.style.overflowY = '';
                                    page.style.overflowX = '';
                                    page.style.height = '';
                                    page.style.maxHeight = '';
                                    page.classList.add('loaded');
                                }
                                
                                // Force enable scrolling on site-content
                                const siteContent = document.querySelector('.site-content');
                                if (siteContent) {
                                    siteContent.style.overflow = '';
                                    siteContent.style.overflowY = '';
                                    siteContent.style.overflowX = '';
                                    siteContent.style.height = '';
                                    siteContent.style.maxHeight = '';
                                }
                                
                                console.log('Scrolling force-enabled');
                            }
                            
                            // Call immediately and multiple times to ensure it works
                            forceEnableScrolling();
                            setTimeout(forceEnableScrolling, 50);
                            setTimeout(forceEnableScrolling, 100);
                            setTimeout(forceEnableScrolling, 200);
                            setTimeout(forceEnableScrolling, 500);
                            setTimeout(forceEnableScrolling, 1000);
                            
                            // Disable Lenis completely to prevent scrolling conflicts on server
                            // Use native scrolling for better compatibility (like page2.html)
                            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
                            
                            // Lenis disabled by default for server compatibility
                            // page2.html works because it doesn't use Lenis
                            const enableLenis = false;
                            
                            if (!isMobile && enableLenis && typeof Lenis !== 'undefined') {
                                try {
                                    const lenis = new Lenis({
                                        duration: 1.2,
                                        easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                                        smoothWheel: true,
                                        smoothTouch: false,
                                        syncTouch: false,
                                        wrapper: window,
                                        content: document.documentElement,
                                    });

                                    function raf(time) {
                                        lenis.raf(time);
                                        requestAnimationFrame(raf);
                                    }
                                    requestAnimationFrame(raf);
                                    
                                    window.lenis = lenis;
                                } catch (error) {
                                    console.warn('Lenis initialization failed:', error);
                                    forceEnableScrolling();
                                }
                            } else {
                                // Use native scrolling (recommended for server compatibility - same as page2.html)
                                forceEnableScrolling();
                            }
                            
                            // Final check after all operations complete - إصلاح نهائي
                            setTimeout(function() {
                                const html = document.documentElement;
                                const body = document.body;
                                const page = document.getElementById('page');
                                const loadingScreen = document.getElementById('loading-screen');
                                
                                // Completely remove loading screen if still present
                                if (loadingScreen) {
                                    loadingScreen.style.display = 'none';
                                    loadingScreen.style.position = 'absolute';
                                    loadingScreen.style.pointerEvents = 'none';
                                    loadingScreen.setAttribute('aria-hidden', 'true');
                                }
                                
                                // Force remove any blocking styles
                                html.style.overflow = '';
                                html.style.overflowY = '';
                                html.style.overflowX = '';
                                html.style.height = '';
                                html.style.maxHeight = '';
                                
                                body.style.overflow = '';
                                body.style.overflowY = '';
                                body.style.overflowX = '';
                                body.style.height = '';
                                body.style.maxHeight = '';
                                
                                if (page) {
                                    page.style.overflow = '';
                                    page.style.overflowY = '';
                                    page.style.overflowX = '';
                                    page.style.height = '';
                                    page.style.maxHeight = '';
                                }
                                
                                // Ensure classes are set
                                html.classList.add('scroll-enabled');
                                body.classList.add('scroll-enabled', 'loaded');
                                if (page) {
                                    page.classList.add('loaded');
                                }
                                
                                // Remove Lenis classes that might block
                                html.classList.remove('lenis', 'lenis-smooth', 'lenis-stopped', 'lenis-locked');
                                body.classList.remove('lenis', 'lenis-smooth', 'lenis-stopped', 'lenis-locked');
                                
                                console.log('Final scrolling check completed - Scrolling should work now (like page2.html)');
                            }, 1500);

                            // Dispatch custom event for other scripts
                            window.dispatchEvent(new CustomEvent('pageLoaded', {
                                detail: {
                                    loadTime: componentState.startTime ? Date.now() - componentState.startTime : null,
                                    errors: componentState.errors,
                                }
                            }));
                        }, 500);
                    }, 500);
                }
            }

            /**
             * Get base path for assets
             * Works correctly on server whether in root or subdirectory
             */
            function getBasePath() {
                // Try to detect from current location
                const path = window.location.pathname;
                const pathArray = path.split('/');
                pathArray.pop(); // Remove filename
                let basePath = pathArray.join('/') || '/';
                
                // Ensure base path starts with /
                if (basePath && !basePath.startsWith('/')) {
                    basePath = '/' + basePath;
                }
                
                // Remove trailing slash
                if (basePath.endsWith('/') && basePath !== '/') {
                    basePath = basePath.slice(0, -1);
                }
                
                return basePath || '';
            }
            
            /**
             * Normalize URL to work on server
             * @param {string} url - Relative or absolute URL
             * @returns {string} Normalized URL
             */
            function normalizeUrl(url) {
                // If URL is already absolute, return as is
                if (url.startsWith('http://') || url.startsWith('https://') || url.startsWith('//')) {
                    return url;
                }
                
                // If URL starts with /, it's already absolute from root
                if (url.startsWith('/')) {
                    return url;
                }
                
                // Otherwise, make it relative to current location
                const basePath = getBasePath();
                if (basePath && basePath !== '/') {
                    // Remove leading ./ or . from URL if present
                    const cleanUrl = url.replace(/^\.\//, '');
                    return basePath + '/' + cleanUrl;
                }
                
                return url;
            }

            /**
             * Load HTML component into container
             * @param {string} containerId - CSS selector for container
             * @param {string} url - URL of HTML component to load
             * @param {number} retryCount - Current retry attempt
             * @returns {Promise} Resolves when component is loaded or failed
             */
            function loadComponent(containerId, url, retryCount = 0) {
                return new Promise((resolve) => {
                    // Validate container exists
                    if (!$(containerId).length) {
                        console.error(`Container ${containerId} not found`);
                        componentState.errors++;
                        updateProgress();
                        resolve();
                        return;
                    }
                    
                    // Normalize URL for server compatibility
                    const normalizedUrl = normalizeUrl(url);
                    
                    // Use fetch API for better error handling
                    fetch(normalizedUrl)
                        .then(response => {
                            if (!response.ok) {
                                // Try original URL if normalized fails
                                if (normalizedUrl !== url) {
                                    console.warn(`Failed to load ${normalizedUrl}, trying original URL ${url}`);
                                    return fetch(url).then(res => {
                                        if (!res.ok) {
                                            throw new Error(`HTTP error! status: ${res.status}`);
                                        }
                                        return res.text();
                                    });
                                }
                                throw new Error(`HTTP error! status: ${response.status}`);
                            }
                            return response.text();
                        })
                        .then(html => {
                            if (!html || html.trim() === '') {
                                throw new Error('Empty response');
                            }
                            
                            // Clean and validate HTML before inserting
                            try {
                                // Remove any potential problematic characters
                                const cleanedHtml = html.trim();
                                
                                // Use DOMParser to validate HTML structure
                                const parser = new DOMParser();
                                const doc = parser.parseFromString(cleanedHtml, 'text/html');
                                
                                // Check for parser errors
                                const parserError = doc.querySelector('parsererror');
                                if (parserError) {
                                    console.warn('HTML parsing warning for', normalizedUrl, parserError.textContent);
                                    // Try to extract valid content despite parser error
                                    const bodyContent = doc.body ? doc.body.innerHTML : cleanedHtml;
                                    if (!bodyContent || bodyContent.trim() === '') {
                                        throw new Error('No valid HTML content found');
                                    }
                                }
                                
                                // Get the container element
                                const container = document.querySelector(containerId);
                                if (!container) {
                                    throw new Error(`Container ${containerId} not found in DOM`);
                                }
                                
                                // Insert HTML using native DOM method to avoid jQuery.appear interference
                                // This bypasses jQuery's html() method which triggers jquery.appear's append hook
                                container.innerHTML = cleanedHtml;
                                
                                // Note: Scripts in dynamically loaded HTML are not executed automatically
                                // If scripts need to run, they should be handled separately
                                // For now, we skip script re-execution to avoid replaceChild issues
                                // Most components don't have inline scripts that need execution
                                
                                // If this is the header container, ensure offcanvas is not hidden after loading
                                if (containerId === '#header-container') {
                                    // Wait a bit for offcanvas elements to be in DOM
                                    setTimeout(function() {
                                        const offcanvasElements = container.querySelectorAll('.offcanvas');
                                        offcanvasElements.forEach(function(element) {
                                            // Only ensure hidden state if not currently showing, showing, or being opened
                                            if (!element.classList.contains('show') && 
                                                !element.classList.contains('showing') &&
                                                !element.hasAttribute('data-offcanvas-opening') &&
                                                element.getAttribute('aria-hidden') !== 'false') {
                                                element.setAttribute('aria-hidden', 'true');
                                            } else if (element.classList.contains('show') || element.classList.contains('showing')) {
                                                // If offcanvas is showing, ensure it stays visible
                                                element.setAttribute('aria-hidden', 'false');
                                            }
                                        });
                                    }, 100);
                                }
                                
                                // Update translations for newly loaded content
                                if (typeof updateContent === 'function') {
                                    // Force update header translations immediately if this is the header
                                    if (containerId === '#header-container') {
                                setTimeout(() => {
                                            updateContent();
                                            // Force update header translations specifically
                                            if (typeof i18next !== 'undefined' && i18next.isInitialized) {
                                                document.querySelectorAll('#header-container [data-i18n], .offcanvas [data-i18n], .nav-link [data-i18n], .nav-link span[data-i18n], .mobile-menu [data-i18n], .mobile-menu span[data-i18n]').forEach(el => {
                                                    const key = el.getAttribute('data-i18n');
                                                    if (key) {
                                                        try {
                                                            const translatedText = i18next.t(key);
                                                            if (translatedText && translatedText !== key && !translatedText.startsWith('translation:')) {
                                                                el.textContent = translatedText;
                                                                el.style.visibility = 'visible';
                                                                el.style.opacity = '1';
                                                                if (el.tagName === 'SPAN') {
                                                                    el.style.display = 'inline-block';
                                                                }
                                                            }
                                                        } catch (error) {
                                                            // Silently handle errors
                                                        }
                                                    }
                                                });
                                            }
                                        }, 50);
                                        // Also update after a longer delay to ensure resources are loaded
                                        setTimeout(() => {
                                            updateContent();
                                        }, 300);
                                    } else {
                                        setTimeout(() => {
                                            updateContent();
                                        }, 100);
                                    }
                                }
                                
                                componentState.loaded++;
                                updateProgress();
                            } catch (e) {
                                console.error('HTML processing error for', url, ':', e);
                                throw new Error('Invalid HTML: ' + e.message);
                            }
                        })
                        .catch(error => {
                            console.error(`Error loading ${normalizedUrl}:`, error);
                            
                            // Try original URL if normalized URL failed
                            if (normalizedUrl !== url && retryCount === 0) {
                                console.log(`Retrying with original URL: ${url}`);
                                return loadComponent(containerId, url, retryCount + 1).then(resolve);
                            }
                            
                            if (retryCount < componentState.maxRetries) {
                                const delay = componentState.retryDelays[retryCount];
                                const statusEl = document.getElementById("loading-status");
                                if (statusEl) {
                                    statusEl.textContent = `خطأ في تحميل ${url}. إعادة المحاولة بعد ${delay / 1000} ثواني...`;
                                }
                                setTimeout(() => {
                                    loadComponent(containerId, url, retryCount + 1)
                                        .then(resolve)
                                        .catch(() => {
                                            componentState.errors++;
                                            updateProgress();
                                            resolve();
                                        });
                                }, delay);
                            } else {
                                componentState.errors++;
                                $(containerId).html(`
                                    <div class="error-message">
                                        <p>تعذر تحميل هذا القسم: ${url}</p>
                                        <p style="font-size: 12px; color: #666; margin-top: 5px;">Base Path: ${getBasePath()}</p>
                                        <button class="retry-button" onclick="retryComponent('${containerId}', '${url}')">
                                            إعادة المحاولة
                                        </button>
                                    </div>
                                `);
                            updateProgress();
                            resolve();
                        }
                    });
                    
                });
            }

            /**
             * Retry loading a failed component
             * @param {string} containerId - CSS selector for container
             * @param {string} url - URL of HTML component to load
             */
            function retryComponent(containerId, url) {
                const container = document.querySelector(containerId);
                if (container) {
                    container.innerHTML = '<div class="text-center">جاري إعادة التحميل...</div>';
                }
                componentState.errors--;
                loadComponent(containerId, url).then(showPage);
            }

            /**
             * Initialize component loading on page ready
             * Uses modern async/await pattern with proper error handling
             */
            $(document).ready(async function () {
                // Record start time for performance tracking
                componentState.startTime = Date.now();
                
                try {
                    // Define components to load (ordered by priority)
                    const components = [
                        {
                            id: "#header-container",
                            url: "assets/components/Header.html",
                        },
                        {
                            id: "#banner-container",
                            url: "assets/components/Banner.html",
                        },
                        {
                            id: "#vision-container",
                            url: "assets/components/Vision.html",
                        },
                        {
                            id: "#services-hero-container",
                            url: "assets/components/Services/ServicesHero.html",
                        },
                        {
                            id: "#services-list-container",
                            url: "assets/components/Services/ServicesList.html",
                        },
                        {
                            id: "#projects-showcase-container",
                            url: "assets/components/Services/ProjectsShowcase.html",
                        },
                        {
                            id: "#team-section-container",
                            url: "assets/components/Services/TeamSection.html",
                        },
                        {
                            id: "#reviews-section-container",
                            url: "assets/components/Services/ReviewsSection.html",
                        },
                        {
                            id: "#faq-container",
                            url: "assets/components/Services/FAQSection.html",
                        },
                        {
                            id: "#footer-container",
                            url: "assets/components/Footer.html",
                        },
                    ];

                    // Set total components count
                    componentState.total = components.length;
                    updateProgress(0);
                    
                    // Load all components in parallel with error handling
                    const loadPromises = components.map((comp) =>
                        loadComponent(comp.id, comp.url).catch((error) => {
                            console.error(`Failed to load component ${comp.id}:`, error);
                            componentState.errors++;
                            updateProgress();
                            return null; // Return null instead of throwing
                        })
                    );
                    
                    // Wait for all components to load (or fail)
                    await Promise.allSettled(loadPromises);
                    
                    // Update translations after all components are loaded
                    if (typeof updateContent === 'function') {
                        setTimeout(() => {
                            // Force update all translations including header
                            updateContent();
                            
                            // Force update header translations specifically with multiple attempts
                            const updateHeaderTranslations = () => {
                                if (typeof i18next === 'undefined' || !i18next.isInitialized) return;
                                
                                document.querySelectorAll('#header-container [data-i18n], .offcanvas [data-i18n], .offcanvas-body [data-i18n], .body-inner [data-i18n], .nav-link [data-i18n], .nav-link span[data-i18n], .mobile-menu [data-i18n], .mobile-menu span[data-i18n]').forEach(el => {
                                    const key = el.getAttribute('data-i18n');
                                    if (key) {
                                        try {
                                            const translatedText = i18next.t(key);
                                            if (translatedText && translatedText !== key && !translatedText.startsWith('translation:')) {
                                                el.textContent = translatedText;
                                                el.style.visibility = 'visible';
                                                el.style.opacity = '1';
                                                if (el.tagName === 'SPAN') {
                                                    el.style.display = 'inline-block';
                                                }
                                            }
                                        } catch (error) {
                                            // Silently handle errors
                                        }
                                    }
                                });
                            };
                            
                            // Update immediately
                            updateHeaderTranslations();
                            
                            // Update again after short delays to ensure all translations are applied
                            setTimeout(updateHeaderTranslations, 100);
                            setTimeout(updateHeaderTranslations, 300);
                            setTimeout(updateHeaderTranslations, 500);
                            setTimeout(updateHeaderTranslations, 800);
                            
                            // Add event listener for offcanvas show to update translations
                            document.addEventListener('shown.bs.offcanvas', function() {
                                setTimeout(() => {
                                    updateHeaderTranslations();
                                    updateContent();
                                }, 50);
                            }, { once: false });
                            
                            // Also trigger language change event to ensure all translations are applied
                                        if (typeof i18next !== 'undefined' && i18next.language) {
                                            if (typeof applyLanguageStyles === 'function') {
                                                applyLanguageStyles(i18next.language);
                                            } else {
                                                // Fallback if applyLanguageStyles is not available
                                                const html = document.documentElement;
                                                const body = document.body;
                                                if (i18next.language === 'ar') {
                                                    html.dir = 'rtl';
                                                    html.lang = 'ar';
                                                    body.classList.add('rtl', 'arabic-font');
                                                    body.classList.remove('ltr', 'latin-font');
                                                } else {
                                                    html.dir = 'ltr';
                                                    html.lang = i18next.language;
                                                    body.classList.add('ltr', 'latin-font');
                                                    body.classList.remove('rtl', 'arabic-font');
                                                }
                                            }
                                        }
                                        
                                        // Add event listener for offcanvas show to update translations
                                        document.addEventListener('shown.bs.offcanvas', function() {
                                            setTimeout(() => {
                                                updateHeaderTranslations();
                                                updateContent();
                                            }, 50);
                                        }, { once: false });
                                    }, 200);
                                }
                    
                    // Final progress update
                    updateProgress(100);
                    
                    // Show page after short delay
                    showPage();
                } catch (error) {
                    console.error("خطأ أثناء تحميل المكونات:", error);
                    const statusEl = document.getElementById("loading-status");
                    if (statusEl) {
                        statusEl.textContent = "حدث خطأ غير متوقع. جاري تحميل الصفحة...";
                    }
                    componentState.errors++;
                    updateProgress(100);
                    showPage();
                }
            });
            
            // Remove no-js class if JavaScript is enabled
            document.documentElement.classList.remove('no-js');
            document.documentElement.classList.add('js');
        </script>

        <script>
            // جلب بيانات الشركة
            document.addEventListener("DOMContentLoaded", async () => {
                try {
                    const response = await fetch(
                        "http://62.84.188.239/api/about_us/index"
                    );
                    const result = await response.json();

                    if (result.status === "success" && result.data) {
                        const data = result.data;

                        // تحديث بيانات الشركة
                        const footerLogo =
                            document.querySelector(".footer-logo");
                        if (footerLogo)
                            footerLogo.textContent =
                                data.company_name || "Company";

                        const emailElement = document.querySelector(
                            '[data-i18n="footer.address.email"]'
                        );
                        if (emailElement)
                            emailElement.textContent = data.contact_email || "";

                        // تحديث روابط التواصل الاجتماعي
                        const socialLinks = {
                            ".fa-facebook-f": data.facebook_url,
                            ".fa-instagram": data.instagram_url,
                            ".fa-linkedin-in": data.linkedin_url,
                            ".fa-twitter": data.github_url,
                        };

                        Object.entries(socialLinks).forEach(
                            ([selector, url]) => {
                                const element =
                                    document.querySelector(
                                        selector
                                    )?.parentElement;
                                if (element && url) element.href = url;
                            }
                        );
                    }
                } catch (error) {
                    console.error("خطأ أثناء جلب بيانات الشركة:", error);
                }
            });
        </script>
    </body>
</html>
